import{k as D,r as o,a as $,l as E,j as e,P as y,b as M,d as Ie,m as z,u as X,c as I,e as A,B as H,Q as Ee,f as _e,g as Ae,T as Me,h as Ge,i as $e}from"./QueryClientProvider-SY5Ag7ZX.js";import{c as Y,u as Te,R as Le,I as Be,L as j}from"./index-MNu_ApZx.js";import{M as K}from"./map-pin-BcT29H21.js";import{B as Oe}from"./bell-D3zR4AsD.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=D("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=D("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=D("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);function J(r){const t=o.useRef({value:r,previous:r});return o.useMemo(()=>(t.current.value!==r&&(t.current.previous=t.current.value,t.current.value=r),t.current.previous),[r])}var q="Radio",[Ve,Z]=$(q),[Ue,He]=Ve(q),ee=o.forwardRef((r,t)=>{const{__scopeRadio:s,name:n,checked:a=!1,required:l,disabled:d,value:c="on",onCheck:i,form:f,...m}=r,[h,x]=o.useState(null),u=E(t,g=>x(g)),p=o.useRef(!1),b=h?f||!!h.closest("form"):!0;return e.jsxs(Ue,{scope:s,checked:a,disabled:d,children:[e.jsx(y.button,{type:"button",role:"radio","aria-checked":a,"data-state":ae(a),"data-disabled":d?"":void 0,disabled:d,value:c,...m,ref:u,onClick:M(r.onClick,g=>{a||i==null||i(),b&&(p.current=g.isPropagationStopped(),p.current||g.stopPropagation())})}),b&&e.jsx(se,{control:h,bubbles:!p.current,name:n,value:c,checked:a,required:l,disabled:d,form:f,style:{transform:"translateX(-100%)"}})]})});ee.displayName=q;var re="RadioIndicator",te=o.forwardRef((r,t)=>{const{__scopeRadio:s,forceMount:n,...a}=r,l=He(re,s);return e.jsx(Ie,{present:n||l.checked,children:e.jsx(y.span,{"data-state":ae(l.checked),"data-disabled":l.disabled?"":void 0,...a,ref:t})})});te.displayName=re;var Ke="RadioBubbleInput",se=o.forwardRef(({__scopeRadio:r,control:t,checked:s,bubbles:n=!0,...a},l)=>{const d=o.useRef(null),c=E(d,l),i=J(s),f=z(t);return o.useEffect(()=>{const m=d.current;if(!m)return;const h=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(h,"checked").set;if(i!==s&&u){const p=new Event("click",{bubbles:n});u.call(m,s),m.dispatchEvent(p)}},[i,s,n]),e.jsx(y.input,{type:"radio","aria-hidden":!0,defaultChecked:s,...a,tabIndex:-1,ref:c,style:{...a.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});se.displayName=Ke;function ae(r){return r?"checked":"unchecked"}var Qe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],T="RadioGroup",[We,vr]=$(T,[Y,Z]),oe=Y(),ne=Z(),[ze,Xe]=We(T),ie=o.forwardRef((r,t)=>{const{__scopeRadioGroup:s,name:n,defaultValue:a,value:l,required:d=!1,disabled:c=!1,orientation:i,dir:f,loop:m=!0,onValueChange:h,...x}=r,u=oe(s),p=Te(f),[b,g]=X({prop:l,defaultProp:a??null,onChange:h,caller:T});return e.jsx(ze,{scope:s,name:n,required:d,disabled:c,value:b,onValueChange:g,children:e.jsx(Le,{asChild:!0,...u,orientation:i,dir:p,loop:m,children:e.jsx(y.div,{role:"radiogroup","aria-required":d,"aria-orientation":i,"data-disabled":c?"":void 0,dir:p,...x,ref:t})})})});ie.displayName=T;var ce="RadioGroupItem",de=o.forwardRef((r,t)=>{const{__scopeRadioGroup:s,disabled:n,...a}=r,l=Xe(ce,s),d=l.disabled||n,c=oe(s),i=ne(s),f=o.useRef(null),m=E(t,f),h=l.value===a.value,x=o.useRef(!1);return o.useEffect(()=>{const u=b=>{Qe.includes(b.key)&&(x.current=!0)},p=()=>x.current=!1;return document.addEventListener("keydown",u),document.addEventListener("keyup",p),()=>{document.removeEventListener("keydown",u),document.removeEventListener("keyup",p)}},[]),e.jsx(Be,{asChild:!0,...c,focusable:!d,active:h,children:e.jsx(ee,{disabled:d,required:l.required,checked:h,...i,...a,name:l.name,ref:m,onCheck:()=>l.onValueChange(a.value),onKeyDown:M(u=>{u.key==="Enter"&&u.preventDefault()}),onFocus:M(a.onFocus,()=>{var u;x.current&&((u=f.current)==null||u.click())})})})});de.displayName=ce;var Ye="RadioGroupIndicator",le=o.forwardRef((r,t)=>{const{__scopeRadioGroup:s,...n}=r,a=ne(s);return e.jsx(te,{...a,...n,ref:t})});le.displayName=Ye;var ue=ie,me=de,Je=le;const pe=o.forwardRef(({className:r,...t},s)=>e.jsx(ue,{className:I("grid gap-2",r),...t,ref:s}));pe.displayName=ue.displayName;const k=o.forwardRef(({className:r,...t},s)=>e.jsx(me,{ref:s,className:I("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),...t,children:e.jsx(Je,{className:"flex items-center justify-center",children:e.jsx(qe,{className:"h-2.5 w-2.5 fill-current text-current"})})}));k.displayName=me.displayName;var L="Switch",[Ze,br]=$(L),[er,rr]=Ze(L),fe=o.forwardRef((r,t)=>{const{__scopeSwitch:s,name:n,checked:a,defaultChecked:l,required:d,disabled:c,value:i="on",onCheckedChange:f,form:m,...h}=r,[x,u]=o.useState(null),p=E(t,N=>u(N)),b=o.useRef(!1),g=x?m||!!x.closest("form"):!0,[w,R]=X({prop:a,defaultProp:l??!1,onChange:f,caller:L});return e.jsxs(er,{scope:s,checked:w,disabled:c,children:[e.jsx(y.button,{type:"button",role:"switch","aria-checked":w,"aria-required":d,"data-state":be(w),"data-disabled":c?"":void 0,disabled:c,value:i,...h,ref:p,onClick:M(r.onClick,N=>{R(B=>!B),g&&(b.current=N.isPropagationStopped(),b.current||N.stopPropagation())})}),g&&e.jsx(ve,{control:x,bubbles:!b.current,name:n,value:i,checked:w,required:d,disabled:c,form:m,style:{transform:"translateX(-100%)"}})]})});fe.displayName=L;var he="SwitchThumb",xe=o.forwardRef((r,t)=>{const{__scopeSwitch:s,...n}=r,a=rr(he,s);return e.jsx(y.span,{"data-state":be(a.checked),"data-disabled":a.disabled?"":void 0,...n,ref:t})});xe.displayName=he;var tr="SwitchBubbleInput",ve=o.forwardRef(({__scopeSwitch:r,control:t,checked:s,bubbles:n=!0,...a},l)=>{const d=o.useRef(null),c=E(d,l),i=J(s),f=z(t);return o.useEffect(()=>{const m=d.current;if(!m)return;const h=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(h,"checked").set;if(i!==s&&u){const p=new Event("click",{bubbles:n});u.call(m,s),m.dispatchEvent(p)}},[i,s,n]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...a,tabIndex:-1,ref:c,style:{...a.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});ve.displayName=tr;function be(r){return r?"checked":"unchecked"}var ge=fe,sr=xe;const P=o.forwardRef(({className:r,...t},s)=>e.jsx(ge,{className:I("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",r),...t,ref:s,children:e.jsx(sr,{className:I("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));P.displayName=ge.displayName;var F="Progress",V=100,[ar,gr]=$(F),[or,nr]=ar(F),je=o.forwardRef((r,t)=>{const{__scopeProgress:s,value:n=null,max:a,getValueLabel:l=ir,...d}=r;(a||a===0)&&!Q(a)&&console.error(cr(`${a}`,"Progress"));const c=Q(a)?a:V;n!==null&&!W(n,c)&&console.error(dr(`${n}`,"Progress"));const i=W(n,c)?n:null,f=G(i)?l(i,c):void 0;return e.jsx(or,{scope:s,value:i,max:c,children:e.jsx(y.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":G(i)?i:void 0,"aria-valuetext":f,role:"progressbar","data-state":we(i,c),"data-value":i??void 0,"data-max":c,...d,ref:t})})});je.displayName=F;var ye="ProgressIndicator",Ne=o.forwardRef((r,t)=>{const{__scopeProgress:s,...n}=r,a=nr(ye,s);return e.jsx(y.div,{"data-state":we(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...n,ref:t})});Ne.displayName=ye;function ir(r,t){return`${Math.round(r/t*100)}%`}function we(r,t){return r==null?"indeterminate":r===t?"complete":"loading"}function G(r){return typeof r=="number"}function Q(r){return G(r)&&!isNaN(r)&&r>0}function W(r,t){return G(r)&&!isNaN(r)&&r<=t&&r>=0}function cr(r,t){return`Invalid prop \`max\` of value \`${r}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${V}\`.`}function dr(r,t){return`Invalid prop \`value\` of value \`${r}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${V} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Re=je,lr=Ne;const Se=o.forwardRef(({className:r,value:t,...s},n)=>e.jsx(Re,{ref:n,className:I("relative h-4 w-full overflow-hidden rounded-full bg-secondary",r),...s,children:e.jsx(lr,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Se.displayName=Re.displayName;function ur(){const[r,t]=o.useState(1),[s,n]=o.useState("Detecting location..."),[a,l]=o.useState("adult"),[d,c]=o.useState(!1),[i,f]=o.useState(!0),[m,h]=o.useState(!0),[x,u]=o.useState(!1),[p,b]=o.useState(""),[g,w]=o.useState("");o.useState({lat:null,lon:null}),o.useState({lat:null,lon:null});const R=3,N=r/R*100;o.useEffect(()=>{if(!localStorage.getItem("username")){A.error("You must be logged in to continue onboarding"),window.location.href="/auth";return}navigator.geolocation?navigator.geolocation.getCurrentPosition(async _=>{const{latitude:S,longitude:C}=_.coords;try{const O=await(await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${S}&longitude=${C}&localityLanguage=en`)).json(),ke=O.city||O.locality||"Unknown",Pe=O.countryName||"";n(`${ke}, ${Pe}`)}catch(U){console.error(U),n("Unable to detect location")}},()=>{n("Location access denied")}):n("Geolocation not supported")},[]);const B=()=>{r<R?t(v=>v+1):Ce()},Ce=async()=>{const v=localStorage.getItem("username")||void 0;if(!v){A.error("Missing user info"),window.location.href="/auth";return}const _={username:v,location:s,ageGroup:a,isSensitive:d,morningSummary:i,thresholdAlerts:m,commuteAlerts:x,enableNotifications:m,routeStart:p,routeEnd:g};try{const S=await fetch("/api/onboarding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)}),C=await S.json();if(!S.ok||!C.success)throw new Error(C.error||C.message||"Onboarding save failed");localStorage.setItem("onboarding_complete","true"),localStorage.setItem("user_settings",JSON.stringify(_)),A.success("Onboarding saved"),window.location.href="/dashboard"}catch(S){A.error(S.message||"Failed to save onboarding")}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-aqi-good/20 via-background to-accent/10",children:e.jsx("div",{className:"w-full max-w-lg",children:e.jsxs("div",{className:"glass-card rounded-3xl p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:["Step ",r," of ",R]}),e.jsxs("span",{className:"text-sm font-medium text-accent",children:[Math.round(N),"%"]})]}),e.jsx(Se,{value:N,className:"h-2"})]}),r===1&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-accent to-aqi-moderate flex items-center justify-center mx-auto mb-4",children:e.jsx(K,{className:"w-8 h-8 text-accent-foreground"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Let's get started"}),e.jsx("p",{className:"text-muted-foreground",children:"We'll personalize your air quality experience"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Your Location"}),e.jsxs("div",{className:"p-4 rounded-2xl border border-border bg-secondary/50 flex items-center gap-3",children:[e.jsx(K,{className:"w-5 h-5 text-accent"}),e.jsx("input",{value:s,onChange:v=>n(v.target.value),className:"bg-transparent outline-none w-full"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your live location is auto-detected."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Route Start"}),e.jsx("input",{className:"w-full p-3 rounded-xl border border-border bg-secondary/50",value:p,placeholder:"Enter starting point",onChange:v=>b(v.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Route End"}),e.jsx("input",{className:"w-full p-3 rounded-xl border border-border bg-secondary/50",value:g,placeholder:"Enter destination",onChange:v=>w(v.target.value)})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(j,{children:"Age Group"}),e.jsxs(pe,{value:a,onValueChange:v=>l(v),children:[e.jsxs("div",{className:"flex items-center space-x-2 p-3 rounded-2xl border border-border hover:bg-secondary/50 transition-colors",children:[e.jsx(k,{value:"child",id:"child"}),e.jsx(j,{htmlFor:"child",className:"flex-1 cursor-pointer",children:"Child (0-12)"})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-3 rounded-2xl border border-border hover:bg-secondary/50 transition-colors",children:[e.jsx(k,{value:"teen",id:"teen"}),e.jsx(j,{htmlFor:"teen",className:"flex-1 cursor-pointer",children:"Teen (13-17)"})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-3 rounded-2xl border border-border hover:bg-secondary/50 transition-colors",children:[e.jsx(k,{value:"adult",id:"adult"}),e.jsx(j,{htmlFor:"adult",className:"flex-1 cursor-pointer",children:"Adult (18-64)"})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-3 rounded-2xl border border-border hover:bg-secondary/50 transition-colors",children:[e.jsx(k,{value:"senior",id:"senior"}),e.jsx(j,{htmlFor:"senior",className:"flex-1 cursor-pointer",children:"Senior (65+)"})]})]})]})]})]}),r===2&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-destructive/80 to-destructive flex items-center justify-center mx-auto mb-4",children:e.jsx(Fe,{className:"w-8 h-8 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Health sensitivity"}),e.jsx("p",{className:"text-muted-foreground",children:"Help us provide better recommendations"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-6 rounded-2xl border border-border bg-secondary/30",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold mb-1",children:"I'm sensitive to air quality"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable if you have asthma, heart conditions, or respiratory issues"})]}),e.jsx(P,{checked:d,onCheckedChange:c,className:"mt-1"})]})}),d&&e.jsx("div",{className:"p-4 rounded-2xl bg-destructive/10 border border-destructive/20 animate-slide-up",children:e.jsx("p",{className:"text-sm text-destructive",children:"We'll provide more cautious recommendations and alert you sooner."})})]})]}),r===3&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-primary to-primary/70 flex items-center justify-center mx-auto mb-4",children:e.jsx(Oe,{className:"w-8 h-8 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Stay informed"}),e.jsx("p",{className:"text-muted-foreground",children:"Get alerts when air quality changes"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-4 rounded-2xl border border-border bg-secondary/30 flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium mb-1",children:"Morning AQI Summary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Daily briefing at 8:00 AM"})]}),e.jsx(P,{checked:i,onCheckedChange:f})]}),e.jsxs("div",{className:"p-4 rounded-2xl border border-border bg-secondary/30 flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium mb-1",children:"AQI Threshold Alerts"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"When air quality becomes unhealthy"})]}),e.jsx(P,{checked:m,onCheckedChange:h})]}),e.jsxs("div",{className:"p-4 rounded-2xl border border-border bg-secondary/30 flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium mb-1",children:"Commute Alerts"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Before your usual travel times"})]}),e.jsx(P,{checked:x,onCheckedChange:u})]})]})]}),e.jsxs("div",{className:"mt-8 flex gap-3",children:[r>1&&e.jsx(H,{variant:"outline",onClick:()=>t(r-1),className:"rounded-2xl h-12 px-6",children:"Back"}),e.jsxs(H,{onClick:B,className:"flex-1 rounded-2xl h-12 text-base font-semibold",children:[r===R?"Get Started":"Continue",e.jsx(De,{className:"w-5 h-5 ml-2"})]})]})]})})})}const mr=new Ee;_e(document.getElementById("root")).render(e.jsx(Ae,{client:mr,children:e.jsxs(Me,{children:[e.jsx(Ge,{}),e.jsx($e,{}),e.jsx(ur,{})]})}));
